<p>Руководство как установить CentOS из под FreeBSD по <span class="caps">SSH</span>.<br />
Задавайте вопросы в комментах, если что-то не понятно.</p>
<p>Данно:<br />
1.Настроенный сервер с kickstart<br />
2.Сервер с FreeBSD любой версии который будем переустанавливать<br />
3.Прямые руки. =)</p>
<p>1.Устанавливаем нужные пакеты из портов(GRUB2 и e2fsprogs) на FreeBSD<br />
cd /usr/ports/sysutils/grub2&amp;&amp;make install<br />
cd /usr/ports/sysutils/e2fsprogs&amp;&amp;make install</p>
<p>2.Создаем на разделе /tmp ext2 файловую систему<br />
/dev/amrd0s1f              1.9G    155M    1.6G     9%    /tmp<br />
/dev/amrd0s1f on /tmp (ufs, local, soft-updates)</p>
<p>umount /tmp<br />
mke2fs /dev/amrd0s1f<br />
mount -t ext2fs /dev/amrd0s1f /mnt</p>
<p>Незабыть удалить из /etc/fstab, чтобы можно было загрузится в <span class="caps">BSD</span> если чтото пойдет не так!</p>
<p>3. Копируем на ext2 раздел initrd и vmlinuz нужной версии<br />
fetch -o /mnt/initrd_remote.img http://mirror.yandex.ru/centos/6.0/os/x86_64/isolinux/initrd.img<br />
fetch -o /mnt/vmlinuz_remote http://mirror.yandex.ru/centos/6.0/os/x86_64/isolinux/vmlinuz</p>
<p>wget -O /initrd_remote.img http://mirror.yandex.ru/centos/6.0/os/x86_64/isolinux/initrd.img<br />
wget -O /vmlinuz_remote http://mirror.yandex.ru/centos/6.0/os/x86_64/isolinux/vmlinuz</p>
<p>4.Устанавливаем grub2 в <span class="caps">MBR</span> и создаем кофиг загрузки<br />
grub2-install /dev/amrd0<br />
grub-mkconfig<br />
/usr/local/etc/grub.d/00_header<br />
/usr/local/etc/grub.d/40_custom<br />
grub-mkconfig -o /boot/grub/grub.cfg</p>
<p>Нужнно поправить /usr/local/etc/grub.d/00_header выставив default=1<br />
В /usr/local/etc/grub.d/40_custom прописать наш новый тип загрузки, для CentOS 6 x64 он будет следующим.<br />
ИЗМЕНИТЬ ВСЕ НУЖНЫЕ ЗНАЧЕНИЯ НА ПРАВИЛЬНЫЕ! <br />
1.root=&#8216;(hd0,1,f)&#8217; &#8211; буква должна соответствовать букве /tmp слайса!! в нашем случае это /dev/amrd0s1f тоесть f<br />
2.ks файл<br />
3.IP\<span class="caps">GATE</span>\<span class="caps">NETMASK</span>!<br />
4.НЕ ЗАБЫТЬ ВЫПОЛНИТЬ grub-mkconfig -o /boot/grub/grub.cfg чтобы обновился конфиг grub!!</p>
<p>menuentry &#8220;CentOS&#8221;  {<br />
        insmod ext2<br />
        set root=&#8216;(hd0,1,f)&#8217;<br />
        linux /vmlinuz_remote lang=en_US keymap=us method=http://ks.example.com/ ks=http://ks.example.com/ks.cfg vnc vncpassword=qwe123 ksdevice=eth0 ip=192.168.0.10 netmask=255.255.255.0 gateway=192.168.0.1 dns=8.8.8.8 noselinux headless<br />
        initrd /initrd_remote.img<br />
}</p>